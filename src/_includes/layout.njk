<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Rosarivo:ital@0;1&display=swap" rel="stylesheet">
  <title>{{ title }}</title>
</head>

<body>
  {% include "header.njk" %}

  <main>
    {{ content | safe }}
  </main>

  <footer>
    <p>&copy; Babette 2025</p>
  </footer>

  <svg style="display: none;">
    <filter id="distortionFilter">
      <feTurbulence id="turbulence" type="turbulence" baseFrequency="0.02" numOctaves="2" result="turbulence" />
      <feDisplacementMap in2="turbulence" in="SourceGraphic" scale="10" xChannelSelector="R" yChannelSelector="G" />
    </filter>
  </svg>

  <svg style="display: none;">
    <filter id="distortionFilterWeak">
      <feTurbulence id="turbulenceWeak" type="turbulence" baseFrequency="0.01" numOctaves="1" result="turbulence" />
      <feDisplacementMap in2="turbulence" in="SourceGraphic" scale="5" xChannelSelector="R" yChannelSelector="G" />
    </filter>
  </svg>

  <script>
    const turbulence = document.getElementById('turbulence');
    const turbulenceWeak = document.getElementById('turbulenceWeak');
    let frames = 0;

    function animateDistortion() {
      const bfX = 0.02 + 0.002 * Math.sin(frames * 0.01);
      const bfY = 0.02 + 0.002 * Math.cos(frames * 0.01);
      turbulence.setAttribute('baseFrequency', `${bfX} ${bfY}`);
      frames++;
      requestAnimationFrame(animateDistortion);
    }

    function animateDistortionWeak() {
      const bfX = 0.01 + 0.001 * Math.sin(frames * 0.01);
      const bfY = 0.01 + 0.001 * Math.cos(frames * 0.01);
      turbulenceWeak.setAttribute('baseFrequency', `${bfX} ${bfY}`);
      frames++;
      requestAnimationFrame(animateDistortionWeak);
    }

    animateDistortion();
    animateDistortionWeak();
  </script>

  <script>
    const burgerMenu = document.querySelector('.burger-menu');
    const mainNav = document.querySelector('.main-nav');

    burgerMenu.addEventListener('click', () => {
      mainNav.classList.toggle('active');
      burgerMenu.classList.toggle('open');
    });
  </script>

  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        }
      });
    }
  </script>
</body>
</html>
